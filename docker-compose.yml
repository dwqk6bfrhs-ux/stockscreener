x-vol-core: &vol_core
  - ./data:/app/data
  - ./logs:/app/logs

x-vol-with-tickers: &vol_with_tickers
  - ./data:/app/data
  - ./logs:/app/logs
  - ./configs:/app/configs:ro
  - ./tickers.txt:/app/tickers.txt:ro

x-vol-report: &vol_report
  - ./data:/app/data
  - ./outputs:/app/outputs
  - ./logs:/app/logs
  - ./configs:/app/configs:ro
  - ./tickers.txt:/app/tickers.txt:ro

x-vol-email: &vol_email
  - ./outputs:/app/outputs
  - ./logs:/app/logs

services:
  universe_fetch:
    build: .
    env_file: .env
    volumes: *vol_core
    entrypoint: ["python", "-m", "src.jobs.universe_fetch"]

  eod_fetch:
    build: .
    env_file: .env
    volumes: *vol_with_tickers
    entrypoint: ["python", "-m", "src.jobs.eod_fetch"]

  hourly_fetch:
    build: .
    env_file: .env
    volumes: *vol_with_tickers
    entrypoint: ["python", "-m", "src.jobs.hourly_fetch"]

  generate_signals:
    build: .
    env_file: .env
    volumes:
      - ./data:/app/data
      - ./logs:/app/logs
      - ./configs:/app/configs:ro
    entrypoint: ["python", "-m", "src.jobs.generate_signals"]

  rank_scores:
    build: .
    env_file: .env
    volumes:
      - ./data:/app/data
      - ./logs:/app/logs
    entrypoint: ["python", "-m", "src.jobs.rank_scores"]

  report:
    build: .
    env_file: .env
    volumes: *vol_report
    entrypoint: ["python", "-m", "src.jobs.report"]

  email:
    build: .
    env_file: .env
    volumes: *vol_email
    entrypoint: ["python", "-m", "src.jobs.send_email"]

  backtest:
    build: .
    env_file: .env
    volumes: *vol_report
    entrypoint: ["python", "-m", "src.jobs.backtest"]

  fred_fetch:
    build: .
    env_file: .env
    volumes:
      - ./data:/app/data
      - ./logs:/app/logs
      - ./configs:/app/configs:ro
    entrypoint: ["python", "-m", "src.jobs.fred_fetch"]

  finra_fetch:
    build: .
    env_file: .env
    volumes:
      - ./data:/app/data
      - ./logs:/app/logs
      - ./configs:/app/configs:ro
    entrypoint: ["python", "-m", "src.jobs.finra_fetch"]

  generate_orders:
    build: .
    env_file: .env
    volumes:
      - ./data:/app/data
      - ./outputs:/app/outputs
      - ./logs:/app/logs
    entrypoint: ["python", "-m", "src.jobs.generate_orders"]
